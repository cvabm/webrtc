
name: AppRTCMobile
env:
    TZ: Asia/Shanghai

on:
  push:
    branches:
      - hack_dev
      - "feature/*"
    tags:
      - "v*.*.*"
  pull_request:
    branches:
      - hack_dev
      - "feature/*"

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
     - uses: actions/checkout@v3
     - uses: actions/setup-python@v4
       with:
         python-version: '3.10' 
     - run: python --version
    
    
    
#     - name: Maximize build space
#       uses: easimon/maximize-build-space@master
#       with:
#         root-reserve-mb: 512
#         swap-size-mb: 1024
#         remove-dotnet: 'true'
#     - name: init custom env
#       run: |
#         BUILD_NAME="AppRTCMobile"
#         BUILD_VERSION="$(date +'%Y%m%d%H%M%S')"
#         BUILD_NAME_WITH_VERSION="$BUILD_NAME-$BUILD_VERSION"
#         echo BUILD_NAME="$BUILD_NAME" >> .custom_env
#         echo BUILD_VERSION="$BUILD_VERSION" >> .custom_env
#         echo BUILD_NAME_WITH_VERSION="$BUILD_NAME_WITH_VERSION" >> .custom_env
#         cat .custom_env
#         cat .custom_env >> $GITHUB_ENV
#         git config --global user.name "$GITHUB_ACTOR"
#         git config --global user.email "ignore@examble.com"

#     - name: build
#       run: |
#         python --version

#     - name: Upload APK
#       uses: actions/upload-artifact@master
#       with:
#         name: android-build
#         path: ${{ env.BUILD_NAME_WITH_VERSION }}-android.apk
#     - name: create release
#       id: create_release
#       uses: actions/create-release@v1
#       env:
#         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
#       with:
#         tag_name: ${{ env.BUILD_VERSION }}
#         release_name: ${{ env.BUILD_VERSION }}
#         body: ${{ github.event.commits[0].message }}
#         draft: true
# #         prerelease: false
#     - name: Upload Release Asset android
#       uses: actions/upload-release-asset@v1
#       env:
#         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
#       with:
#         upload_url: ${{ steps.create_release.outputs.upload_url }}
#         asset_path: ${{ env.BUILD_NAME_WITH_VERSION }}-android.apk
#         asset_name: ${{ env.BUILD_NAME_WITH_VERSION }}-android.apk
#         asset_content_type: application/zip
#     - name: public release
#       uses: eregon/publish-release@v1
#       env:
#         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
#       with:
#         release_id: ${{ steps.create_release.outputs.id }}
